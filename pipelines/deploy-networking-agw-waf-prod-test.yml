trigger: none

variables:
  - template: "/.azuredevops/pipelineVariables/global.variables.yml"
  - group: "Network-WAF-Prod-Variables"

stages:
  # Networking connectivity deployment
  - template: /.azuredevops/pipelineTemplates/main.yml
    parameters:
      targetEnvironment: $(targetEnvironment)
      subscriptionId: $(subscriptionId)
      managementGroupId: $(managementGroupId)
  #   tenantId: 'xxxx-xxxx-xxx-xxxx'
  #   deploymentSpId: 'xxxx-xxxx-xxx-xxxx'
  #   resourceGroupName: 'xxxx-xxxx-xxx-xxxx'
      deploymentBlocks:
        - Path: deployment/networking/waf-prod
          templateFilePath: main.bicep # Should only be specified if not deploy.bicep or deploy.json
          parametersPath: main.dev.bicepparam
          jobName: Networking_WAF_Prod_Test_Deployment
          displayName: 'Azure Networking Application Gateway with WAF (PROD - Development) Deployment'
          # customParameterFileTokens: '{"tokenName":"tokenValue"}'
          # prereqScript: prereqs.ps1
          # postDeploymentScript: postDeployment.ps1