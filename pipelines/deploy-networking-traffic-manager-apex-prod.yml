trigger: none

variables:
  - template: "/.azuredevops/pipelineVariables/global.variables.yml"
  - group: "Network-TrafficManager-Variables"

stages:
  # Networking connectivity deployment
  - template: /.azuredevops/pipelineTemplates/main.yml
    parameters:
      targetEnvironment: $(targetEnvironment)
      subscriptionId: $(subscriptionId)
  #   managementGroupId: $(managementGroupId)
  #   tenantId: 'xxxx-xxxx-xxx-xxxx'
  #   deploymentSpId: 'xxxx-xxxx-xxx-xxxx'
  #   resourceGroupName: 'xxxx-xxxx-xxx-xxxx'
      deploymentBlocks:
        - Path: deployment/networking/tm-apex-prod
          templateFilePath: main.bicep # Should only be specified if not deploy.bicep or deploy.json
          parametersPath: main.bicepparam
          jobName: Apex_Networking_Traffic_Manager_Deployment
          displayName: 'Apex Azure Networking Traffic Manager Deployment'
          # customParameterFileTokens: '{"tokenName":"tokenValue"}'
          # prereqScript: prereqs.ps1
          # postDeploymentScript: postDeployment.ps1